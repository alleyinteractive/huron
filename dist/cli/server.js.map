{"version":3,"sources":["../../src/cli/server.js"],"names":["startWebpack","webpack","require","WebpackDevServer","config","huron","webpackConfig","compiler","progress","apply","ProgressPlugin","percentage","msg","console","log","production","run","err","server","hot","quiet","noInfo","stats","colors","hash","version","assets","chunks","modules","reasons","children","source","contentBase","root","publicPath","port","listen"],"mappings":";;;;;kBAcwBA,Y;;AAZxB;;;;;;AAEA,IAAMC,UAAUC,QAAQ,SAAR,CAAhB,C,CAJA;;AAKA,IAAMC,mBAAmBD,QAAQ,oBAAR,CAAzB;;AAEA;;;;;;;AAOe,SAASF,YAAT,CAAsBI,MAAtB,EAA8B;AAC3C,MAAMC,QAAQD,OAAOC,KAArB;AACA,MAAMC,gBAAgBF,OAAOH,OAA7B;AACA,MAAMM,WAAWN,QAAQK,aAAR,CAAjB;;AAEA,MAAI,oBAAQE,QAAZ,EAAsB;AACpBD,aAASE,KAAT,CACE,IAAIR,QAAQS,cAAZ,CACE,UAACC,UAAD,EAAaC,GAAb,EAAqB;AACnBC,cAAQC,GAAR,CAAgBH,aAAa,GAA7B,SAAuCC,GAAvC;AACD,KAHH,CADF;AAOD;;AAED,MAAI,oBAAQG,UAAZ,EAAwB;AACtBR,aAASS,GAAT,CAAa,UAACC,GAAD,EAAS;AACpB,UAAIA,GAAJ,EAAS;AACPJ,gBAAQC,GAAR,CAAYG,GAAZ;AACD;AACF,KAJD;AAKD,GAND,MAMO;AACL,QAAMC,SAAS,IAAIf,gBAAJ,CAAqBI,QAArB,EAA+B;AAC5CY,WAAK,IADuC;AAE5CC,aAAO,KAFqC;AAG5CC,cAAQ,KAHoC;AAI5CC,aAAO;AACLC,gBAAQ,IADH;AAELC,cAAM,KAFD;AAGLC,iBAAS,KAHJ;AAILC,gBAAQ,KAJH;AAKLC,gBAAQ,KALH;AAMLC,iBAAS,KANJ;AAOLC,iBAAS,KAPJ;AAQLC,kBAAU,KARL;AASLC,gBAAQ;AATH,OAJqC;AAe5CC,mBAAa3B,MAAM4B,IAfyB;AAgB5CC,wCAAgC7B,MAAM8B,IAAtC,SAA8C9B,MAAM4B;AAhBR,KAA/B,CAAf;AAkBAf,WAAOkB,MAAP,CACE/B,MAAM8B,IADR,EAEE,WAFF,EAGE,UAAClB,GAAD,EAAS;AACP,UAAIA,GAAJ,EAAS;AACP,eAAOJ,QAAQC,GAAR,CAAYG,GAAZ,CAAP;AACD;;AAEDJ,cAAQC,GAAR,oCAA6CT,MAAM8B,IAAnD;AACA,aAAO,IAAP;AACD,KAVH;AAYD;AACF","file":"server.js","sourcesContent":["/** @module cli/webpack-server */\n\nimport program from './parse-args';\n\nconst webpack = require('webpack');\nconst WebpackDevServer = require('webpack-dev-server');\n\n/**\n * Spin up webpack-dev-server or, if production flag is set, run webpack a single time\n *\n * @function startWebpack\n * @param {object} config - webpack configuration, preprocessed by {@link module:cli/generate-config generateConfig}\n * @see {@link module:cli/generate-config generateConfig}\n */\nexport default function startWebpack(config) {\n  const huron = config.huron;\n  const webpackConfig = config.webpack;\n  const compiler = webpack(webpackConfig);\n\n  if (program.progress) {\n    compiler.apply(\n      new webpack.ProgressPlugin(\n        (percentage, msg) => {\n          console.log(`${(percentage * 100)}% `, msg);\n        }\n      )\n    );\n  }\n\n  if (program.production) {\n    compiler.run((err) => {\n      if (err) {\n        console.log(err);\n      }\n    });\n  } else {\n    const server = new WebpackDevServer(compiler, {\n      hot: true,\n      quiet: false,\n      noInfo: false,\n      stats: {\n        colors: true,\n        hash: false,\n        version: false,\n        assets: false,\n        chunks: false,\n        modules: false,\n        reasons: false,\n        children: false,\n        source: false,\n      },\n      contentBase: huron.root,\n      publicPath: `http://localhost:${huron.port}/${huron.root}`,\n    });\n    server.listen(\n      huron.port,\n      'localhost',\n      (err) => {\n        if (err) {\n          return console.log(err);\n        }\n\n        console.log(`Listening at http://localhost:${huron.port}/`);\n        return true;\n      }\n    );\n  }\n}\n"]}